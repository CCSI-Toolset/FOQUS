% This file shows posteriors plots
% ns  - set to 1 for 1-step smoothing of 2D contours
% ns1 - set to 1 for 1-step smoothing of 1D histgrams
ns  = 0;
ns1 = 0;
if exist('noCLF') 
   hold off
else
   clf
end;
active = [
1
1
1
];
L = [
-2.000000e+000 -1.000000e+000 -3.000000e+000 ];
U = [
2.000000e+000 4.000000e+000 6.000000e+000 ];
iStr = {
'calc.x1','calc.x2','calc.x3'};
X = zeros(3,20);
D = zeros(3,20);
DP = zeros(3,20);
NC = zeros(3,3,20,20);
NCP = zeros(3,3,20,20);
X(1,:) = [
-1.900000e+000 -1.700000e+000 -1.500000e+000 -1.300000e+000 -1.100000e+000 -9.000000e-001 -7.000000e-001 -5.000000e-001 -3.000000e-001 -1.000000e-001 1.000000e-001 3.000000e-001 5.000000e-001 7.000000e-001 9.000000e-001 1.100000e+000 1.300000e+000 1.500000e+000 1.700000e+000 1.900000e+000 ];
D(1,:) = [
1.167331e-004 6.394185e-004 1.740542e-003 5.810520e-003 1.485124e-002 3.289782e-002 6.041721e-002 9.544933e-002 1.339817e-001 1.546034e-001 1.558700e-001 1.302044e-001 9.717245e-002 6.061583e-002 3.258072e-002 1.471534e-002 5.868015e-003 1.841595e-003 4.704169e-004 1.533211e-004 ];
DP(1,:) = [
1.181818e-004 6.454545e-004 1.754545e-003 5.845455e-003 1.491818e-002 3.300000e-002 6.053636e-002 9.554545e-002 1.340091e-001 1.545455e-001 1.557455e-001 1.300727e-001 9.707273e-002 6.056364e-002 3.256364e-002 1.471818e-002 5.872727e-003 1.845455e-003 4.727273e-004 1.545455e-004 ];
NC(1,2,:,:) = [
0 0 0 0 0 5 10 25 15 10 0 0 0 0 0 0 0 0 0 0 
0 0 0 5 5 25 66 98 41 67 41 15 0 0 0 0 0 0 0 0 
0 0 0 0 30 102 206 175 186 124 78 67 15 10 0 0 0 0 0 0 
0 5 10 82 97 273 460 658 706 478 375 130 46 10 0 0 0 0 0 0 
0 15 51 149 407 672 1409 1547 1446 1474 766 354 177 20 26 5 0 0 0 0 
0 10 123 340 888 1683 2657 3426 3708 2951 1618 940 407 109 15 0 0 0 0 0 
5 61 190 568 1522 3212 5219 6279 6756 5318 3175 1546 564 214 36 5 0 0 0 0 
5 41 278 931 2360 5306 8162 10018 10796 8580 4822 2336 909 177 52 5 0 0 0 0 
5 92 346 1317 3179 7265 11616 14613 14866 11290 6924 3485 1394 365 109 15 5 5 0 0 
10 113 451 1443 3943 8493 13265 16770 17041 13258 8220 3772 1378 469 88 15 0 0 0 0 
10 77 321 1466 3948 8104 13369 17102 17130 13478 8417 3896 1596 432 88 15 0 5 0 0 
15 93 400 1223 3050 6832 11157 14145 14351 11637 6654 3413 1308 359 83 5 0 0 0 0 
15 77 281 969 2374 5436 8491 10745 10368 8185 4948 2524 984 254 93 20 0 0 0 0 
5 26 265 610 1456 3093 5294 6652 6681 5195 3083 1531 671 176 31 10 0 5 0 0 
10 15 109 339 705 1735 2801 3652 3561 2895 1589 853 353 62 15 0 0 0 0 0 
0 5 31 167 355 684 1301 1681 1429 1402 770 420 160 20 15 0 0 0 0 0 
0 0 10 47 203 323 459 605 604 562 280 192 46 25 5 0 0 0 0 0 
0 0 0 15 20 104 177 198 229 145 72 51 30 10 0 0 0 0 0 0 
0 0 0 0 10 26 31 57 46 31 31 20 15 0 0 0 0 0 0 0 
0 0 0 5 0 10 10 15 31 10 5 0 0 0 0 0 0 0 0 0 
]';
NCP(1,2,:,:) = [
0 0 0 0 0 1 2 5 3 2 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 1 5 13 19 8 13 8 3 0 0 0 0 0 0 0 0 
0 0 0 0 6 20 40 34 36 24 15 13 3 2 0 0 0 0 0 0 
0 1 2 16 19 53 89 127 136 92 72 25 9 2 0 0 0 0 0 0 
0 3 10 29 79 130 272 298 278 283 147 68 34 4 5 1 0 0 0 0 
0 2 24 66 172 325 512 659 712 566 310 180 78 21 3 0 0 0 0 0 
1 12 37 110 294 619 1004 1206 1296 1019 608 296 108 41 7 1 0 0 0 0 
1 8 54 180 455 1021 1568 1922 2069 1643 923 447 174 34 10 1 0 0 0 0 
1 18 67 254 612 1396 2229 2801 2847 2161 1325 667 267 70 21 3 1 1 0 0 
2 22 87 278 758 1630 2543 3212 3262 2537 1573 722 264 90 17 3 0 0 0 0 
2 15 62 282 758 1554 2561 3274 3278 2579 1611 746 306 83 17 3 0 1 0 0 
3 18 77 235 585 1309 2136 2707 2746 2227 1274 654 251 69 16 1 0 0 0 0 
3 15 54 186 455 1041 1625 2056 1984 1567 948 484 189 49 18 4 0 0 0 0 
1 5 51 117 279 592 1013 1273 1279 995 591 294 129 34 6 2 0 1 0 0 
2 3 21 65 135 332 536 699 682 555 305 164 68 12 3 0 0 0 0 0 
0 1 6 32 68 131 249 322 274 269 148 81 31 4 3 0 0 0 0 0 
0 0 2 9 39 62 88 116 116 108 54 37 9 5 1 0 0 0 0 0 
0 0 0 3 4 20 34 38 44 28 14 10 6 2 0 0 0 0 0 0 
0 0 0 0 2 5 6 11 9 6 6 4 3 0 0 0 0 0 0 0 
0 0 0 1 0 2 2 3 6 2 1 0 0 0 0 0 0 0 0 0 
]';
NC(1,3,:,:) = [
0 0 0 0 5 5 5 10 15 0 5 0 5 5 5 5 0 0 0 0 
25 36 10 15 5 20 15 15 31 10 20 20 10 20 10 15 15 31 20 15 
31 36 51 41 51 15 51 51 56 46 46 46 77 36 51 36 82 62 51 72 
160 129 134 160 155 119 160 218 181 207 165 197 197 150 171 160 186 129 176 170 
353 394 451 410 436 374 488 462 441 426 545 420 431 405 462 379 405 368 477 389 
936 962 1056 920 926 858 858 900 1087 931 863 983 1003 956 987 972 992 915 837 930 
1786 1828 1505 1786 1666 1729 1875 1869 1619 1759 1780 1848 1822 1754 1723 1562 1692 1577 1801 1686 
2851 2862 2544 2799 2757 2731 2799 2544 2752 2674 2689 2626 2746 2897 2631 2725 2913 2647 2642 2944 
3860 3720 3809 3793 3934 3839 3688 3636 3844 3990 3969 3859 3739 3922 3797 3922 3797 3985 3916 3870 
4354 4724 4406 4358 4552 4290 4750 4452 4405 4332 4484 4285 4692 4404 4598 4368 4550 4404 4164 4154 
4689 4512 4392 4303 4412 4501 4391 4642 4694 4402 4380 4381 4401 4548 4302 4475 4699 4329 4370 4631 
3875 3823 3771 3818 3677 3593 3802 4000 3797 3635 3781 3765 3713 3713 3833 3525 3520 3598 3844 3640 
2909 2951 2966 2491 2794 2679 2742 2627 2810 2810 2773 2684 3008 2972 2831 2648 2841 2710 2695 2825 
1764 1707 1707 1770 1786 1582 1812 1707 1749 1791 1812 1655 1571 1660 1749 1723 1796 1770 1796 1874 
1054 1111 944 871 866 798 965 939 923 918 991 918 950 871 939 908 872 944 950 955 
495 526 464 354 506 427 427 422 422 370 385 433 406 386 464 412 344 339 438 417 
177 119 182 151 130 135 229 192 182 166 255 187 140 145 119 156 140 156 213 182 
36 46 57 51 72 31 41 67 41 26 46 67 67 67 62 57 41 52 72 46 
5 15 26 10 10 20 0 20 5 10 25 5 15 10 15 5 15 15 15 20 
5 5 10 0 20 5 5 0 0 0 0 0 5 5 5 0 10 5 5 0 
]';
NCP(1,3,:,:) = [
0 0 0 0 1 1 1 2 3 0 1 0 1 1 1 1 0 0 0 0 
5 7 2 3 1 4 3 3 6 2 4 4 2 4 2 3 3 6 4 3 
6 7 10 8 10 3 10 10 11 9 9 9 15 7 10 7 16 12 10 14 
31 25 26 31 30 23 31 42 35 40 32 38 38 29 33 31 36 25 34 33 
68 76 87 79 84 72 94 89 85 82 105 81 83 78 89 73 78 71 92 75 
180 185 203 177 178 165 165 173 209 179 166 189 193 184 190 187 191 176 161 179 
343 351 289 343 320 332 360 359 311 338 342 355 350 337 331 300 325 303 346 324 
547 549 488 537 529 524 537 488 528 513 516 504 527 556 505 523 559 508 507 565 
740 713 730 727 754 736 707 697 737 765 761 740 717 752 728 752 728 764 751 742 
834 905 844 835 872 822 910 853 844 830 859 821 899 844 881 837 872 844 798 796 
898 864 841 824 845 862 841 889 899 843 839 839 843 871 824 857 900 829 837 887 
742 732 722 731 704 688 728 766 727 696 724 721 711 711 734 675 674 689 736 697 
557 565 568 477 535 513 525 503 538 538 531 514 576 569 542 507 544 519 516 541 
338 327 327 339 342 303 347 327 335 343 347 317 301 318 335 330 344 339 344 359 
202 213 181 167 166 153 185 180 177 176 190 176 182 167 180 174 167 181 182 183 
95 101 89 68 97 82 82 81 81 71 74 83 78 74 89 79 66 65 84 80 
34 23 35 29 25 26 44 37 35 32 49 36 27 28 23 30 27 30 41 35 
7 9 11 10 14 6 8 13 8 5 9 13 13 13 12 11 8 10 14 9 
1 3 5 2 2 4 0 4 1 2 5 1 3 2 3 1 3 3 3 4 
1 1 2 0 4 1 1 0 0 0 0 0 1 1 1 0 2 1 1 0 
]';
NC(2,1,:,:) = [
0 0 0 0 0 0 5 5 5 10 10 15 15 5 10 0 0 0 0 0 
0 0 0 5 15 10 61 41 92 113 77 93 77 26 15 5 0 0 0 0 
0 0 0 10 51 123 190 278 346 451 321 400 281 265 109 31 10 0 0 0 
0 5 0 82 149 340 568 931 1317 1443 1466 1223 969 610 339 167 47 15 0 5 
0 5 30 97 407 888 1522 2360 3179 3943 3948 3050 2374 1456 705 355 203 20 10 0 
5 25 102 273 672 1683 3212 5306 7265 8493 8104 6832 5436 3093 1735 684 323 104 26 10 
10 66 206 460 1409 2657 5219 8162 11616 13265 13369 11157 8491 5294 2801 1301 459 177 31 10 
25 98 175 658 1547 3426 6279 10018 14613 16770 17102 14145 10745 6652 3652 1681 605 198 57 15 
15 41 186 706 1446 3708 6756 10796 14866 17041 17130 14351 10368 6681 3561 1429 604 229 46 31 
10 67 124 478 1474 2951 5318 8580 11290 13258 13478 11637 8185 5195 2895 1402 562 145 31 10 
0 41 78 375 766 1618 3175 4822 6924 8220 8417 6654 4948 3083 1589 770 280 72 31 5 
0 15 67 130 354 940 1546 2336 3485 3772 3896 3413 2524 1531 853 420 192 51 20 0 
0 0 15 46 177 407 564 909 1394 1378 1596 1308 984 671 353 160 46 30 15 0 
0 0 10 10 20 109 214 177 365 469 432 359 254 176 62 20 25 10 0 0 
0 0 0 0 26 15 36 52 109 88 88 83 93 31 15 15 5 0 0 0 
0 0 0 0 5 0 5 5 15 15 15 5 20 10 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 5 0 5 0 0 5 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
]';
NCP(2,1,:,:) = [
0 0 0 0 0 0 1 1 1 2 2 3 3 1 2 0 0 0 0 0 
0 0 0 1 3 2 12 8 18 22 15 18 15 5 3 1 0 0 0 0 
0 0 0 2 10 24 37 54 67 87 62 77 54 51 21 6 2 0 0 0 
0 1 0 16 29 66 110 180 254 278 282 235 186 117 65 32 9 3 0 1 
0 1 6 19 79 172 294 455 612 758 758 585 455 279 135 68 39 4 2 0 
1 5 20 53 130 325 619 1021 1396 1630 1554 1309 1041 592 332 131 62 20 5 2 
2 13 40 89 272 512 1004 1568 2229 2543 2561 2136 1625 1013 536 249 88 34 6 2 
5 19 34 127 298 659 1206 1922 2801 3212 3274 2707 2056 1273 699 322 116 38 11 3 
3 8 36 136 278 712 1296 2069 2847 3262 3278 2746 1984 1279 682 274 116 44 9 6 
2 13 24 92 283 566 1019 1643 2161 2537 2579 2227 1567 995 555 269 108 28 6 2 
0 8 15 72 147 310 608 923 1325 1573 1611 1274 948 591 305 148 54 14 6 1 
0 3 13 25 68 180 296 447 667 722 746 654 484 294 164 81 37 10 4 0 
0 0 3 9 34 78 108 174 267 264 306 251 189 129 68 31 9 6 3 0 
0 0 2 2 4 21 41 34 70 90 83 69 49 34 12 4 5 2 0 0 
0 0 0 0 5 3 7 10 21 17 17 16 18 6 3 3 1 0 0 0 
0 0 0 0 1 0 1 1 3 3 3 1 4 2 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 0 1 0 0 1 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
]';
X(2,:) = [
-8.750000e-001 -6.250000e-001 -3.750000e-001 -1.250000e-001 1.250000e-001 3.750000e-001 6.250000e-001 8.750000e-001 1.125000e+000 1.375000e+000 1.625000e+000 1.875000e+000 2.125000e+000 2.375000e+000 2.625000e+000 2.875000e+000 3.125000e+000 3.375000e+000 3.625000e+000 3.875000e+000 ];
D(2,:) = [
1.428673e-004 1.108093e-003 5.003842e-003 1.687054e-002 4.279400e-002 9.302232e-002 1.501274e-001 1.889874e-001 1.916513e-001 1.517513e-001 9.038450e-002 4.452409e-002 1.753435e-002 4.740757e-003 1.151650e-003 1.707439e-004 8.711424e-006 2.613427e-005 0.000000e+000 0.000000e+000 ];
DP(2,:) = [
1.454545e-004 1.118182e-003 5.036364e-003 1.694545e-002 4.291818e-002 9.316364e-002 1.502000e-001 1.889273e-001 1.915000e-001 1.516000e-001 9.030000e-002 4.450000e-002 1.753636e-002 4.745455e-003 1.154545e-003 1.727273e-004 9.090909e-006 2.727273e-005 0.000000e+000 0.000000e+000 ];
NC(2,3,:,:) = [
5 0 5 5 5 0 5 0 5 0 15 10 0 5 5 0 0 0 5 10 
31 36 10 36 41 41 15 20 15 25 10 15 46 67 31 61 25 51 31 20 
140 176 114 134 139 108 93 145 134 217 155 103 171 165 124 145 181 124 166 129 
540 384 436 462 514 431 441 472 483 519 482 592 587 504 467 493 488 441 446 493 
1254 1108 1238 1269 1207 1259 1384 1264 1243 1087 1253 1372 1238 1263 1118 1160 1258 1202 1144 1232 
2615 2652 2648 2474 2683 2714 2761 2652 2552 2657 2787 2751 2636 2693 2625 2588 2686 2760 2599 2848 
4486 4381 4188 4318 4334 3985 4178 4225 4788 4271 4249 4370 4463 4359 4302 4046 4359 4239 4327 4291 
5606 5590 5293 5141 5396 5318 5600 5407 5475 5302 5485 5250 5370 5709 5641 5344 5694 4973 5610 5255 
5566 5603 5666 5473 5530 5394 5525 5613 5493 5655 5540 5018 5482 5566 5613 5362 5414 5508 5362 5608 
4533 4753 4256 4256 4408 4168 4564 4439 4288 4481 4293 4314 4533 4126 4272 4121 4262 4371 4371 4282 
2783 2726 2543 2705 2553 2554 2543 2626 2585 2480 2663 2590 2486 2553 2674 2653 2574 2465 2580 2533 
1174 1357 1399 1216 1258 1132 1211 1253 1373 1185 1388 1274 1226 1268 1216 1409 1268 1300 1206 1435 
490 495 558 474 506 453 573 485 432 490 526 521 552 511 516 474 516 453 506 521 
114 187 119 99 166 171 177 135 161 88 125 135 172 99 104 151 156 109 104 140 
20 62 15 41 10 15 26 36 26 36 36 57 36 36 41 46 20 41 26 25 
10 0 0 0 10 10 10 5 5 10 5 10 0 5 5 0 10 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 5 0 5 0 0 0 0 0 5 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
]';
NCP(2,3,:,:) = [
1 0 1 1 1 0 1 0 1 0 3 2 0 1 1 0 0 0 1 2 
6 7 2 7 8 8 3 4 3 5 2 3 9 13 6 12 5 10 6 4 
27 34 22 26 27 21 18 28 26 42 30 20 33 32 24 28 35 24 32 25 
104 74 84 89 99 83 85 91 93 100 93 114 113 97 90 95 94 85 86 95 
241 213 238 244 232 242 266 243 239 209 241 264 238 243 215 223 242 231 220 237 
502 509 508 475 515 521 530 509 490 510 535 528 506 517 504 497 516 530 499 547 
860 840 803 828 831 764 801 810 918 819 815 838 856 836 825 776 836 813 830 823 
1074 1071 1014 985 1034 1019 1073 1036 1049 1016 1051 1006 1029 1094 1081 1024 1091 953 1075 1007 
1066 1073 1085 1048 1059 1033 1058 1075 1052 1083 1061 961 1050 1066 1075 1027 1037 1055 1027 1074 
868 910 815 815 844 798 874 850 821 858 822 826 868 790 818 789 816 837 837 820 
533 522 487 518 489 489 487 503 495 475 510 496 476 489 512 508 493 472 494 485 
225 260 268 233 241 217 232 240 263 227 266 244 235 243 233 270 243 249 231 275 
94 95 107 91 97 87 110 93 83 94 101 100 106 98 99 91 99 87 97 100 
22 36 23 19 32 33 34 26 31 17 24 26 33 19 20 29 30 21 20 27 
4 12 3 8 2 3 5 7 5 7 7 11 7 7 8 9 4 8 5 5 
2 0 0 0 2 2 2 1 1 2 1 2 0 1 1 0 2 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 1 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
]';
NC(3,1,:,:) = [
0 25 31 160 353 936 1786 2851 3860 4354 4689 3875 2909 1764 1054 495 177 36 5 5 
0 36 36 129 394 962 1828 2862 3720 4724 4512 3823 2951 1707 1111 526 119 46 15 5 
0 10 51 134 451 1056 1505 2544 3809 4406 4392 3771 2966 1707 944 464 182 57 26 10 
0 15 41 160 410 920 1786 2799 3793 4358 4303 3818 2491 1770 871 354 151 51 10 0 
5 5 51 155 436 926 1666 2757 3934 4552 4412 3677 2794 1786 866 506 130 72 10 20 
5 20 15 119 374 858 1729 2731 3839 4290 4501 3593 2679 1582 798 427 135 31 20 5 
5 15 51 160 488 858 1875 2799 3688 4750 4391 3802 2742 1812 965 427 229 41 0 5 
10 15 51 218 462 900 1869 2544 3636 4452 4642 4000 2627 1707 939 422 192 67 20 0 
15 31 56 181 441 1087 1619 2752 3844 4405 4694 3797 2810 1749 923 422 182 41 5 0 
0 10 46 207 426 931 1759 2674 3990 4332 4402 3635 2810 1791 918 370 166 26 10 0 
5 20 46 165 545 863 1780 2689 3969 4484 4380 3781 2773 1812 991 385 255 46 25 0 
0 20 46 197 420 983 1848 2626 3859 4285 4381 3765 2684 1655 918 433 187 67 5 0 
5 10 77 197 431 1003 1822 2746 3739 4692 4401 3713 3008 1571 950 406 140 67 15 5 
5 20 36 150 405 956 1754 2897 3922 4404 4548 3713 2972 1660 871 386 145 67 10 5 
5 10 51 171 462 987 1723 2631 3797 4598 4302 3833 2831 1749 939 464 119 62 15 5 
5 15 36 160 379 972 1562 2725 3922 4368 4475 3525 2648 1723 908 412 156 57 5 0 
0 15 82 186 405 992 1692 2913 3797 4550 4699 3520 2841 1796 872 344 140 41 15 10 
0 31 62 129 368 915 1577 2647 3985 4404 4329 3598 2710 1770 944 339 156 52 15 5 
0 20 51 176 477 837 1801 2642 3916 4164 4370 3844 2695 1796 950 438 213 72 15 5 
0 15 72 170 389 930 1686 2944 3870 4154 4631 3640 2825 1874 955 417 182 46 20 0 
]';
NCP(3,1,:,:) = [
0 5 6 31 68 180 343 547 740 834 898 742 557 338 202 95 34 7 1 1 
0 7 7 25 76 185 351 549 713 905 864 732 565 327 213 101 23 9 3 1 
0 2 10 26 87 203 289 488 730 844 841 722 568 327 181 89 35 11 5 2 
0 3 8 31 79 177 343 537 727 835 824 731 477 339 167 68 29 10 2 0 
1 1 10 30 84 178 320 529 754 872 845 704 535 342 166 97 25 14 2 4 
1 4 3 23 72 165 332 524 736 822 862 688 513 303 153 82 26 6 4 1 
1 3 10 31 94 165 360 537 707 910 841 728 525 347 185 82 44 8 0 1 
2 3 10 42 89 173 359 488 697 853 889 766 503 327 180 81 37 13 4 0 
3 6 11 35 85 209 311 528 737 844 899 727 538 335 177 81 35 8 1 0 
0 2 9 40 82 179 338 513 765 830 843 696 538 343 176 71 32 5 2 0 
1 4 9 32 105 166 342 516 761 859 839 724 531 347 190 74 49 9 5 0 
0 4 9 38 81 189 355 504 740 821 839 721 514 317 176 83 36 13 1 0 
1 2 15 38 83 193 350 527 717 899 843 711 576 301 182 78 27 13 3 1 
1 4 7 29 78 184 337 556 752 844 871 711 569 318 167 74 28 13 2 1 
1 2 10 33 89 190 331 505 728 881 824 734 542 335 180 89 23 12 3 1 
1 3 7 31 73 187 300 523 752 837 857 675 507 330 174 79 30 11 1 0 
0 3 16 36 78 191 325 559 728 872 900 674 544 344 167 66 27 8 3 2 
0 6 12 25 71 176 303 508 764 844 829 689 519 339 181 65 30 10 3 1 
0 4 10 34 92 161 346 507 751 798 837 736 516 344 182 84 41 14 3 1 
0 3 14 33 75 179 324 565 742 796 887 697 541 359 183 80 35 9 4 0 
]';
NC(3,2,:,:) = [
5 31 140 540 1254 2615 4486 5606 5566 4533 2783 1174 490 114 20 10 0 0 0 0 
0 36 176 384 1108 2652 4381 5590 5603 4753 2726 1357 495 187 62 0 0 0 0 0 
5 10 114 436 1238 2648 4188 5293 5666 4256 2543 1399 558 119 15 0 0 0 0 0 
5 36 134 462 1269 2474 4318 5141 5473 4256 2705 1216 474 99 41 0 0 0 0 0 
5 41 139 514 1207 2683 4334 5396 5530 4408 2553 1258 506 166 10 10 0 0 0 0 
0 41 108 431 1259 2714 3985 5318 5394 4168 2554 1132 453 171 15 10 0 0 0 0 
5 15 93 441 1384 2761 4178 5600 5525 4564 2543 1211 573 177 26 10 0 0 0 0 
0 20 145 472 1264 2652 4225 5407 5613 4439 2626 1253 485 135 36 5 0 0 0 0 
5 15 134 483 1243 2552 4788 5475 5493 4288 2585 1373 432 161 26 5 0 0 0 0 
0 25 217 519 1087 2657 4271 5302 5655 4481 2480 1185 490 88 36 10 0 0 0 0 
15 10 155 482 1253 2787 4249 5485 5540 4293 2663 1388 526 125 36 5 0 5 0 0 
10 15 103 592 1372 2751 4370 5250 5018 4314 2590 1274 521 135 57 10 0 0 0 0 
0 46 171 587 1238 2636 4463 5370 5482 4533 2486 1226 552 172 36 0 0 5 0 0 
5 67 165 504 1263 2693 4359 5709 5566 4126 2553 1268 511 99 36 5 0 0 0 0 
5 31 124 467 1118 2625 4302 5641 5613 4272 2674 1216 516 104 41 5 5 0 0 0 
0 61 145 493 1160 2588 4046 5344 5362 4121 2653 1409 474 151 46 0 0 0 0 0 
0 25 181 488 1258 2686 4359 5694 5414 4262 2574 1268 516 156 20 10 0 0 0 0 
0 51 124 441 1202 2760 4239 4973 5508 4371 2465 1300 453 109 41 0 0 0 0 0 
5 31 166 446 1144 2599 4327 5610 5362 4371 2580 1206 506 104 26 0 0 5 0 0 
10 20 129 493 1232 2848 4291 5255 5608 4282 2533 1435 521 140 25 0 0 0 0 0 
]';
NCP(3,2,:,:) = [
1 6 27 104 241 502 860 1074 1066 868 533 225 94 22 4 2 0 0 0 0 
0 7 34 74 213 509 840 1071 1073 910 522 260 95 36 12 0 0 0 0 0 
1 2 22 84 238 508 803 1014 1085 815 487 268 107 23 3 0 0 0 0 0 
1 7 26 89 244 475 828 985 1048 815 518 233 91 19 8 0 0 0 0 0 
1 8 27 99 232 515 831 1034 1059 844 489 241 97 32 2 2 0 0 0 0 
0 8 21 83 242 521 764 1019 1033 798 489 217 87 33 3 2 0 0 0 0 
1 3 18 85 266 530 801 1073 1058 874 487 232 110 34 5 2 0 0 0 0 
0 4 28 91 243 509 810 1036 1075 850 503 240 93 26 7 1 0 0 0 0 
1 3 26 93 239 490 918 1049 1052 821 495 263 83 31 5 1 0 0 0 0 
0 5 42 100 209 510 819 1016 1083 858 475 227 94 17 7 2 0 0 0 0 
3 2 30 93 241 535 815 1051 1061 822 510 266 101 24 7 1 0 1 0 0 
2 3 20 114 264 528 838 1006 961 826 496 244 100 26 11 2 0 0 0 0 
0 9 33 113 238 506 856 1029 1050 868 476 235 106 33 7 0 0 1 0 0 
1 13 32 97 243 517 836 1094 1066 790 489 243 98 19 7 1 0 0 0 0 
1 6 24 90 215 504 825 1081 1075 818 512 233 99 20 8 1 1 0 0 0 
0 12 28 95 223 497 776 1024 1027 789 508 270 91 29 9 0 0 0 0 0 
0 5 35 94 242 516 836 1091 1037 816 493 243 99 30 4 2 0 0 0 0 
0 10 24 85 231 530 813 953 1055 837 472 249 87 21 8 0 0 0 0 0 
1 6 32 86 220 499 830 1075 1027 837 494 231 97 20 5 0 0 1 0 0 
2 4 25 95 237 547 823 1007 1074 820 485 275 100 27 5 0 0 0 0 0 
]';
X(3,:) = [
-2.775000e+000 -2.325000e+000 -1.875000e+000 -1.425000e+000 -9.750000e-001 -5.250000e-001 -7.500000e-002 3.750000e-001 8.250000e-001 1.275000e+000 1.725000e+000 2.175000e+000 2.625000e+000 3.075000e+000 3.525000e+000 3.975000e+000 4.425000e+000 4.875000e+000 5.325000e+000 5.775000e+000 ];
D(3,:) = [
5.117988e-002 5.142554e-002 4.964318e-002 4.897588e-002 5.012057e-002 4.836782e-002 5.072166e-002 5.014844e-002 5.063629e-002 4.967454e-002 5.057008e-002 4.945850e-002 5.054046e-002 5.041501e-002 5.011534e-002 4.888876e-002 5.038540e-002 4.886089e-002 4.964144e-002 5.023033e-002 ];
DP(3,:) = [
5.117273e-002 5.141818e-002 4.963636e-002 4.897273e-002 5.011818e-002 4.836364e-002 5.071818e-002 5.014545e-002 5.063636e-002 4.967273e-002 5.057273e-002 4.946364e-002 5.054545e-002 5.041818e-002 5.011818e-002 4.889091e-002 5.039091e-002 4.886364e-002 4.964545e-002 5.023636e-002 ];
nInps  = length(active);
nPlots = 0;
for ii = 1 : nInps
   if (active(ii) == 1)
      nPlots = nPlots + 1;
      active(ii) = nPlots;
   end;
end;
dzero = 0;
XOpt(1) = 2.388612e-001;
XOpt(2) = 1.150389e+000;
XOpt(3) = -1.219851e+000;
for ii = 1 : nInps
  for jj = ii : nInps
    if (active(ii) ~= 0 & active(jj) ~= 0)
      index = (active(ii)-1) * nPlots + active(jj);
      subplot(nPlots,nPlots,index)
      if (ii == jj)
        n = length(D(ii,:));
        DN = D(ii,:);
        for kk = 1 : ns1
          DN1 = DN;
          for ll = 2 : n-1
            DN(ll) = DN(ll) + DN1(ll+1);
            DN(ll) = DN(ll) + DN1(ll-1);
            DN(ll) = DN(ll) / 3;
          end;
        end;
        bar(X(ii,:), DN, 1.0);
        hold on
        plot([XOpt(ii) XOpt(ii)],[0 max(DN)],'r-','LineWidth',2)
        plot(X(ii,:),DP(ii,:),'c-','LineWidth',2);
        xmin = min(X(ii,:));
        xmax = max(X(ii,:));
        xwid = xmax - xmin;
        xmin = xmin - 0.5 * xwid / 20;
        xmax = xmax + 0.5 * xwid / 20;
        ymax = max(DN);
        axis([xmin xmax 0 ymax])
        set(gca,'linewidth',2)
        set(gca,'fontweight','bold')
        set(gca,'fontsize',12)
        xlabel(iStr(ii),'FontWeight','bold','FontSize',12)
        if (ii == 1)
        ylabel('Probabilities','FontWeight','bold','FontSize',12)
        end;
        grid on
        box on
      else
        n = length(X(jj,:));
        XT = X(jj,:);
        YT = X(ii,:);
        HX = (XT(n) - XT(1)) / (n-1);
        HY = (YT(n) - YT(1)) / (n-1);
        ZZ = squeeze(NC(ii,jj,:,:));
        for kk = 1 : ns
          ZZ1 = ZZ;
          for ll = 2 : n-1
            for mm = 2 : n-1
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) / 9;
            end;
          end;
        end;
        ZZ = ZZ / (sum(sum(ZZ)));
%      [YY,XX]=meshgrid(XT(1):HX:XT(n),YT(1):HY:YT(n));
%      HX = 0.01 * (XT(n) - XT(1));
%      HY = 0.01 * (YT(n) - YT(1));
%      [YI,XI]=meshgrid(XT(1):HX:XT(n),YT(1):HY:YT(n));
%      ZI=interp2(YY, XX, ZZ, YI, XI, 'spline');
%      pcolor(XI,YI,ZI)
%      shading interp
%      hold on
%      contour(XI,YI,ZI,5,'k')
        imagesc(ZZ')
        xtick = L(ii):(U(ii)-L(ii))/4:U(ii);
        set(gca,'XTick',0:n/4:n);
        set(gca,'XTickLabel', xtick);
        ytick = L(jj):(U(jj)-L(jj))/4:U(jj);
        set(gca,'YTick',0:n/4:n);
        set(gca,'YTickLabel', ytick);
        set(gca,'YDir', 'normal');
        xlabel(iStr(jj),'FontWeight','bold','FontSize',12)
        ylabel(iStr(ii),'FontWeight','bold','FontSize',12)
set(gca,'linewidth',2)
set(gca,'fontweight','bold')
set(gca,'fontsize',10)
box on
        index = (active(jj)-1) * nPlots + active(ii);
        subplot(nPlots,nPlots,index)
        ZZ = squeeze(NCP(ii,jj,:,:));
        for kk = 1 : ns
          ZZ1 = ZZ;
          for ll = 2 : n-1
            for mm = 2 : n-1
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll-1,mm+1);
              ZZ(ll,mm) = ZZ(ll,mm) + ZZ1(ll+1,mm-1);
              ZZ(ll,mm) = ZZ(ll,mm) / 9;
            end;
          end;
        end;
        ZZ = ZZ / (sum(sum(ZZ)));
        imagesc(ZZ')
        xtick = L(ii):(U(ii)-L(ii))/4:U(ii);
        set(gca,'XTick',0:n/4:n);
        set(gca,'XTickLabel', xtick);
        ytick = L(jj):(U(jj)-L(jj))/4:U(jj);
        set(gca,'YTick',0:n/4:n);
        set(gca,'YTickLabel', ytick);
        set(gca,'YDir', 'normal');
        xlabel(iStr(jj),'FontWeight','bold','FontSize',12)
        ylabel(iStr(ii),'FontWeight','bold','FontSize',12)
        if (ii == 1 & jj == 2)
          title('Prior','FontWeight','bold','FontSize',12)
        end;
set(gca,'linewidth',2)
set(gca,'fontweight','bold')
set(gca,'fontsize',10)
box on
      end;
    end;
  end;
end;
      subplot(nPlots,nPlots,1)
set(gcf,'NextPlot','add');
axes;
h=title('MCMC Priors/Posteriors, best -log(likelihood)=2.618323e-014','fontSize',12,'fontWeight','bold');
set(gca,'Visible','off');
set(h,'Visible','on');
negll = 2.618323e-014;
disp('Lower diagonal plots: priors')
disp('Upper diagonal plots: posteriors')
